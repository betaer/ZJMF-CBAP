<!-- 页面独有样式 -->
<link rel="stylesheet" href="/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/css/dcim_goods.css">
<div id="template" v-cloak>
  <top-menu></top-menu>
  <div class="buy-box">
    <div class="custom-box">
      <van-form ref="orderForm" scroll-to-error>
        <!-- 地区 -->
        <van-select :columns="dataList" :value="areText" :columns-names=" { text: 'name', value: 'id' }"
          right-icon="arrow" :label="lang.common_cloud_label1" cur-class="form-select select-field show-field"
          @change="changeCity">
          <template #input>
            <img v-if="areImg" :src="`/upload/common/country/${areImg}.png`" alt="" class="country-icon">
            {{areText}}
          </template>
          <template #option="option">
            <img v-if="option.iso" :src="`/upload/common/country/${option.iso}.png`" alt="" class="country-icon">
            {{option.name}}
          </template>
        </van-select>
        <!-- 可用区 -->
        <van-select :columns="calcAreaList" :value="area_name" :columns-names=" { text: 'name', value: 'id' }"
          right-icon="arrow" :label="lang.usable_area" cur-class="form-select select-field show-field mar-b-30"
          @change="changeArea">
        </van-select>
        <!-- 机型配置 -->
        <div class="config-box">
          <van-field v-model="modelConfigText" :label="lang.model_config" class="select-field show-field"
            right-icon="arrow" @click="showConfigPick = true" clickable readonly label-align="top">
          </van-field>
        </div>

        <!-- 增值选配 -->
        <template v-if="filterConfig.id">
          <!-- 内存 -->
          <div class="config-box" v-if="filterConfig.optional_memory.length > 0 ">
            <div class="renew">
              <span>{{lang.optional_memory}}</span>
              <van-switch v-model="memorySwitch" size=".5333rem" @change="changeDiskSwitch($event,'optional_memory')">
              </van-switch>
            </div>
            <van-field class=" disk-box show-field" readonly label-align="top"
              v-if="memorySwitch && filterConfig.optional_memory.length > 0">
              <template #input>
                <div class="disk-detail">
                  <template v-for="(item,index) in params.optional_memory">
                    <div class="disk-item" @click="editOption(index,'optional_memory')">
                      <div class="system-Disk">
                        <div>
                          <p> {{item.value || item.id}}</p>
                          <p class="system-size">× {{item.num}}</p>
                        </div>
                        <div class="system-icon">
                          <van-icon name="arrow"></van-icon>
                        </div>
                      </div>
                      <div class="del-icon" @click.stop="delConfig('optional_memory', index)">
                        <van-icon name="delete"></van-icon>
                      </div>
                    </div>
                  </template>
                  <div class="store" @click="checkOption('optional_memory')">
                    <van-icon name="add" class="add-icon" v-if="showAddMemory"></van-icon>
                    <span v-if="showAddMemory">{{lang.increase_memory}}</span>
                    <span class="tip">{{lang.mf_dcim_tip1}}<span class="num"> {{calcMemoryNum}}
                      </span>{{lang.mf_dcim_tip2}}
                    </span>
                    <span class="tip" v-if="filterConfig.max_memory_num !== 0 && filterConfig.mem_max !== 0">，</span>
                    <span class="tip" v-if="filterConfig.max_memory_num !== 0">
                      <span class="num">{{calcMemoryCapacity}}G</span>
                      {{lang.common_cloud_label20}}
                    </span>
                  </div>
                </div>
              </template>
            </van-field>
          </div>
          <!-- 硬盘 -->
          <div class="config-box" v-if="filterConfig.optional_disk.length > 0 ">
            <div class="renew">
              <span>{{lang.optional_disk}}</span>
              <van-switch v-model="diskSwitch" size=".5333rem" @change="changeDiskSwitch($event,'optional_disk')">
              </van-switch>
            </div>
            <van-field class=" disk-box show-field" readonly label-align="top"
              v-if="diskSwitch && filterConfig.optional_disk.length > 0">
              <template #input>
                <div class="disk-detail">
                  <template v-for="(item,index) in params.optional_disk">
                    <div class="disk-item" @click="editOption(index,'optional_disk')">
                      <div class="system-Disk">
                        <div>
                          <p> {{item.value || item.id}}</p>
                          <p class="system-size">× {{item.num}}</p>
                        </div>
                        <div class="system-icon">
                          <van-icon name="arrow"></van-icon>
                        </div>
                      </div>
                      <div class="del-icon" @click.stop="delConfig('optional_disk', index)">
                        <van-icon name="delete"></van-icon>
                      </div>
                    </div>
                  </template>
                  <div class="store" @click="checkOption('optional_disk')">
                    <van-icon name="add" class="add-icon" v-if="showAddDisk"></van-icon>
                    <span v-if="showAddDisk">{{lang.increase_disk}}</span>
                    <span class="tip" v-if="filterConfig.disk_max_num !== 0">{{lang.mf_dcim_tip1}}<span class="num">
                        {{calcDiskNum}} </span>{{lang.mf_dcim_tip3}}</span>
                  </div>
                </div>
              </template>
            </van-field>
          </div>
          <!-- 显卡 -->
          <div class="config-box" v-if="filterConfig.optional_gpu.length > 0 ">
            <div class="renew">
              <span>{{lang.optional_gpu}}</span>
              <van-switch v-model="gpuSwitch" size=".5333rem" @change="changeDiskSwitch($event,'optional_gpu')">
              </van-switch>
            </div>
            <van-field class=" disk-box show-field" readonly label-align="top"
              v-if="gpuSwitch && filterConfig.optional_gpu.length > 0">
              <template #input>
                <div class="disk-detail">
                  <template v-for="(item,index) in params.optional_gpu">
                    <div class="disk-item" @click="editOption(index,'optional_gpu')">
                      <div class="system-Disk">
                        <div>
                          <p> {{item.value || item.id}}</p>
                          <p class="system-size">× {{item.num}}</p>
                        </div>
                        <div class="system-icon">
                          <van-icon name="arrow"></van-icon>
                        </div>
                      </div>
                      <div class="del-icon" @click.stop="delConfig('optional_gpu', index)">
                        <van-icon name="delete"></van-icon>
                      </div>
                    </div>
                  </template>
                  <div class="store" @click="checkOption('optional_gpu')">
                    <van-icon name="add" class="add-icon" v-if="showAddGpu"></van-icon>
                    <span v-if="showAddGpu">{{lang.increase_gpu}}</span>
                    <span class="tip" v-if="filterConfig.max_gpu_num !== 0">
                      {{lang.mf_dcim_tip1}}
                      <span class="num"> {{calcGpuNum}} </span>
                      {{lang.mf_dcim_tip12}}
                    </span>
                  </div>
                </div>
              </template>
            </van-field>
          </div>
        </template>
        <!-- 线路 -->
        <div class="config-box">
          <van-field v-model="lineName" :das="calcLineList" :label="lang.mf_line" class="select-field show-field"
            right-icon="arrow" @click="showLinePick = true" clickable readonly label-align="top">
          </van-field>
        </div>
        <!-- 公网IP -->
        <van-select :columns="ipData" :value="ipName" :columns-names=" { text: 'value', value: 'value' }"
          right-icon="arrow" :label="lang.common_cloud_title3" cur-class="form-select select-field show-field"
          @change="changeIp">
          <template #option="option">
            {{calcIpUnit(option.value)}}
          </template>
        </van-select>
        <!-- 带宽 -->
        <template v-if="lineDetail.bill_type === 'bw' && lineDetail.bw.length > 0">
          <van-select v-if="lineDetail.bw[0].type === 'radio'" :columns="calcBwList" :value="bwName"
            :columns-names=" { text: 'value', value: 'value' }" right-icon="arrow" :label="lang.mf_bw"
            cur-class="form-select select-field show-field mar-b-30" @change="changeBw">
            <template #option="option">
              {{ option.value === 'NC' ? lang.actual_bw : (option.value + 'M')}}
            </template>
          </van-select>
          <div class="config-box" v-else>
            <div class="lebal-box">
              <span>{{lang.mf_bw}}</span>
              <van-stepper v-model="params.bw" :min="calcBwRange[0] * 1" :max="calcBwRange[calcBwRange.length -1] * 1"
                @change="changeBwNum"></van-stepper>
            </div>
            <div class="slider-box">
              <van-slider v-model="params.bw" :min="calcBwRange[0] * 1" :max="calcBwRange[calcBwRange.length -1] * 1"
                bar-height=".1067rem" @change="changeBwNum">
                <template #button>
                  <div class="custom-button">{{ params.bw }}</div>
                </template>
              </van-slider>
              <div class="unit">M</div>
            </div>
            <div class="marks">
              <span class="item">{{lineDetail.bw[0].min_value}}M</span>
              <span class="item">{{lineDetail.bw[lineDetail.bw.length -1 ].max_value}}M</span>
            </div>
          </div>
        </template>
        <!-- 流量 -->
        <van-select v-if="lineDetail.bill_type === 'flow' && lineDetail.flow.length > 0" :columns="lineDetail.flow"
          :value="flowName" :columns-names=" { text: 'value', value: 'value' }" right-icon="arrow" :label="lang.mf_flow"
          cur-class="form-select select-field show-field mar-b-30" @change="changeFlow">
          <template #option="option">
            {{option.value > 0 ? option.value + 'G' : lang.mf_tip28}}
          </template>
        </van-select>
        <!-- 防御 -->
        <van-select v-if="lineDetail.defence && lineDetail.defence.length >0" :columns="lineDetail.defence"
          :value="defenseName" :columns-names=" { text: 'value', value: 'value' }" right-icon="arrow"
          :label="lang.mf_defense" cur-class="form-select select-field show-field mar-b-30" @change="chooseDefence">
          <template #option="option">
            {{ option.value == 0 ? lang.no_defense : option.value + 'G'}}
          </template>
        </van-select>
        <!-- 镜像 -->
        <div class="config-box" id="image">
          <van-field :label="lang.cloud_menu_5" class="select-field show-field" right-icon="arrow"
            @click="isShowImage = true" clickable readonly label-align="top">
            <template #input>
              <img
                :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/mf_cloud/${curImageIcon}.svg`"
                alt="" class="image-icon" v-if="curImageIcon" />
              {{imageText}}
            </template>
          </van-field>
          <div class="van-field__error-message" v-if="showImage">{{lang.mf_tip6}}</div>
        </div>
        <template v-if="isLogin">
          <!-- 其他配置 -->
          <!-- 登录方式 -->
          <div class="config-box" id="ssh">
            <van-field :label="lang.login_way" class="select-field show-field" readonly label-align="top">
              <template #input>
                <img :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cloudDetail/ssh.svg`"
                  alt="" class="image-icon" v-if="login_way === lang.security_tab1">
                <img :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cloudDetail/password.svg`"
                  alt="" class="image-icon" v-if="login_way === lang.set_pas">
                <img :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cloudDetail/auto.svg`"
                  alt="" class="image-icon" v-if="login_way === lang.auto_create">
                {{login_way}}
              </template>
            </van-field>
            <div class="p-30 van-field__error-message" v-show="showPas">{{lang.mf_tip20}}</div>
            <div class="p-30 van-field__error-message" v-show="showRepass">{{lang.mf_tip19}}</div>
            <div v-show="showSsh" class="p-30 van-field__error-message">{{lang.placeholder_pre2}}{{lang.security_tab1}}
            </div>
          </div>

          <!-- 实例名称 -->
          <div class="config-box">
            <van-field v-model="params.notes" :label="lang.cloud_name" :placeholder="lang.mf_tip15"
              class="select-field show-field" label-align="top">
            </van-field>
          </div>
          <!-- 付费周期 -->
          <div class="config-box">
            <van-field :label="lang.common_cloud_label8" right-icon="arrow" @click="isShowDur = true"
              class="select-field show-field" clickable readonly label-align="top">
              <template #input>
                <div>{{commonData.currency_prefix + selectDuration.price + ' ' + commonData.currency_code + ' / ' +
                  selectDuration.name }}</div>
              </template>
            </van-field>
          </div>
          <!-- 自动续费 -->
          <div class="config-box renew">
            <span>{{lang.auto_renew}}</span>
            <van-switch v-model="params.auto_renew" size=".5333rem"></van-switch>
          </div>
        </template>
        <custom-goods :id="id" v-model:self_defined_field="self_defined_field" curclass="select-field show-field"
          ref="customGoodRef">
        </custom-goods>
      </van-form>
    </div>
    <div class="botton-buy-btn">
      <div class="price-box">
        <span class="pre-text" @click="showConfigPage = !showConfigPage">{{lang.product_preview}}</span>
        <div class="pre-color">
          <div>
            <span>{{commonData.currency_prefix}}{{filterMoney(calcTotalPrice)}}&nbsp;{{commonData.currency_code}}</span>
            <van-popover placement="top-end" v-if="totalPrice * 1  != calcTotalPrice*1">
              <div class="sure-remind">
                <p v-if="levelNum">{{lang.shoppingCar_tip_text2}}：{{commonData.currency_prefix}} {{
                  filterMoney(levelNum) }}</p>
                <p v-if="discount">{{lang.shoppingCar_tip_text4}}：{{commonData.currency_prefix}} {{
                  filterMoney(discount)}}</p>
                <p v-if="promo.event_promotion">{{lang.goods_text4}}：{{commonData.currency_prefix}} {{
                  filterMoney(eventDiscount)}}</p>
              </div>
              <template #reference>
                <van-icon name="info-o" class="help"></van-icon>
              </template>
            </van-popover>
          </div>
          <p class="original-price" v-if="totalPrice * 1  != calcTotalPrice*1">{{commonData.currency_prefix}}
            {{filterMoney(totalPrice * 1)}}
          </p>
          <!-- 优惠码 -->
          <div class="discount-box">
            <discount-code v-if="!discount" @get-discount="getDiscount" scene='new' :product_id='id' :qty="qty"
              :amount="totalPrice" :billing_cycle_time="duration">
            </discount-code>
            <div class="discount-codeNumber" v-else>{{promo.promo_code}}
              <van-icon name="close" class="remove-discountCode" @click="canclePromo"></van-icon>
            </div>
            <event-code :eventpromotion="promo.event_promotion" :product_id='id' :qty="qty" :amount="totalPrice"
              :billing_cycle_time="duration" @change="eventChange">
            </event-code>
          </div>

        </div>
      </div>
      <van-button @click="submitOrder" :loading="submitLoading" type="primary" block
        class="btn-ok">{{lang.product_buy_now}}</van-button>
    </div>
  </div>

  <!-- 磁盘更改 -->
  <van-popup v-model:show="showSystemDisk" position="right" :style="{ width: '100%', height: '100%' }">
    <div class="disk-pop">
      <div class="disk-top">
        <div class="left-icon" @click="showSystemDisk = false">
          <van-icon name="arrow-left"></van-icon>
        </div>
        <div class="config-title" v-if="editType === 'optional_memory'">{{lang.add_memory}}</div>
        <div class="config-title" v-if="editType === 'optional_disk'">{{lang.add_disk}}</div>
        <div class="config-title" v-if="editType === 'optional_gpu'">{{lang.add_gpu}}</div>
        <div></div>
      </div>
      <div class="disk-main">
        <van-form>
          <van-cell-group inset>
            <template v-for="(item,index) in params[editType]">

              <template v-if="index === editDiskIndex">
                <van-field :model-value="params[editType][editDiskIndex].value || params[editType][editDiskIndex].id"
                  is-link readonly input-align="right" :label="lang.type_text" @click="handelDiskPick">
                </van-field>
                <van-field :label="lang.shoppingCar_goodsNums" input-align="right">
                  <template #input>
                    <van-stepper v-model="params[editType][editDiskIndex].num" :min="1" :max="calcMaxNum(item)"
                      @change="getCycleList">
                    </van-stepper>
                  </template>
                </van-field>
              </template>
            </template>
          </van-cell-group>
        </van-form>
      </div>
      <div class="disk-btn">
        <van-button class="can-btn" block @click="showSystemDisk = false">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="showSystemDisk = false">
          {{ lang.ticket_btn6}}
        </van-button>
      </div>
    </div>
  </van-popup>

  <!-- 磁盘类型选择 -->
  <van-popup v-model:show="showDiskPicker" position="bottom" teleport="body">
    <van-picker :columns="calcMemoryType" ref="diskPopRef" :columns-field-names="{ text: 'value', value: 'id'}">
      <template #toolbar>
        <div class="tool-bar">
          <img class="cancel-btn" @click="showDiskPicker = false"
            src="/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cancel.svg" alt="">
          <span class="tool-title">{{lang.optional_memory}}</span>
          <span class="tool-confirm" @click="onDiskConfirm">{{lang.template_text135}}</span>
        </div>
      </template>
      <template #option="option">
        {{option.value ||  option.id}}
      </template>
    </van-picker>
  </van-popup>

  <van-popup v-model:show="showImgPick" position="bottom" teleport="body">
    <van-picker option-height=".96rem" visible-option-num="8" :columns="calcImageList"
      :columns-field-names="{ text: 'name', value: 'id' }" ref="selectPopRef">
      <template #toolbar>
        <div class="tool-bar">
          <img class="cancel-btn" @click="showSelect = false"
            src="/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cancel.svg" alt="">
          <span class="tool-title">{{title}}</span>
          <span class="tool-confirm" @click="handelSelectImg">{{lang.template_text135}}</span>
        </div>
      </template>
    </van-picker>
  </van-popup>

  <van-action-sheet v-model:show="isShowImage" :round="false">
    <div class="action-select">
      <div class="action-title">
        <div class="left-icon">
          <img class="cancel-btn" @click="isShowImage = false"
            src="/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cancel.svg" alt="">
        </div>
        <div class="title-text">{{lang.cloud_menu_5}}</div>
        <div></div>
      </div>
      <div class="action-conctet image-action">
        <div class="image-action-item" v-for="item in imageList" @click="changeImage(item)">
          <div class="select-name">
            <img :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/mf_cloud/${item.icon}.svg`"
              alt="" class="image-icon" />
            <span>{{item.name}}</span>
          </div>
          <van-icon name="arrow"></van-icon>
        </div>
      </div>
    </div>
  </van-action-sheet>


  <van-popup v-model:show="isShowDur" closeable style="width: 90%;">
    <div class="common-pop-box">
      <div class="common-pop-title">{{lang.common_cloud_label8}}</div>
      <div class="common-pop-body">
        <div class="duration-box">
          <div class="item" :class="{active:params.duration_id === item.id }" v-for="item in cycleList" :key="item.id"
            @click="chooseDuration(item.id,item)">
            <p class="money">{{commonData.currency_prefix}}{{item.price}}&nbsp;{{commonData.currency_code}}</p>
            <p class="cycle">{{item.name}}</p>
            <span class="tip" v-if="item.discount">{{item.discount}}{{lang.mf_tip25}}</span>
          </div>
        </div>
      </div>
      <div class="common-pop-fotter">
        <van-button class="can-btn" block @click="isShowDur = false">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="isShowDur = false">{{ lang.ticket_btn6}}</van-button>
      </div>
    </div>
  </van-popup>


  <!-- 配置弹窗 -->
  <van-popup v-model:show="showConfigPage" position="right" :style="{ width: '100%', height: '100%' }">
    <div class="config-detail">
      <div class="config-top">
        <div class="left-icon" @click="showConfigPage = false">
          <van-icon name="arrow-left"></van-icon>
        </div>
        <div class="config-title">{{lang.product_preview}}</div>
        <div></div>
      </div>
      <dic class="config-mid">
        <div class="right-top">
          <div class="right-title">
            <p class="des">
              <span>{{tit}}</span>
              <span
                v-if="base_price*1">{{commonData.currency_prefix}}{{filterMoney(Number(base_price).toFixed(2))}}</span>
            </p>
          </div>
          <div class="info">
            <p class="des" v-for="(item,index) in showInfo" :key="index">
              <span class="name">{{item.name}}</span>
              <span class="value" :title="item.value">{{item.value}}</span>
              <span class="price">{{commonData.currency_prefix}}{{ filterMoney(item.price)}}</span>
            </p>
          </div>
        </div>
        <div class="subtotal">
          <div class="label">{{lang.shoppingCar_goodsNums}}</div>
          <div class="value del-add">
            <van-stepper v-model="qty" min="1" max="999" @change="changQty"></van-stepper>
          </div>
        </div>
      </dic>
      <div class="botton-buy-btn">
        <div class="price-box">
          <span class="pre-text"></span>
          <div class="pre-color">
            <div>
              <span>{{commonData.currency_prefix}}{{calcTotalPrice}}&nbsp;{{commonData.currency_code}}</span>
              <van-popover placement="top-end" v-if="totalPrice * 1  != calcTotalPrice*1">
                <div class="sure-remind">
                  <p v-if="levelNum">{{lang.shoppingCar_tip_text2}}：{{commonData.currency_prefix}} {{
                    filterMoney(levelNum) }}</p>
                  <p v-if="discount">{{lang.shoppingCar_tip_text4}}：{{commonData.currency_prefix}} {{
                    filterMoney(discount)}}</p>
                  <p v-if="promo.event_promotion">{{lang.goods_text4}}：{{commonData.currency_prefix}} {{
                    filterMoney(eventDiscount)}}</p>
                </div>
                <template #reference>
                  <van-icon name="info-o" class="help"></van-icon>
                </template>
              </van-popover>
            </div>
            <p class="original-price" v-if="totalPrice * 1  != calcTotalPrice*1">
              {{commonData.currency_prefix}}
              {{filterMoney(totalPrice * 1)}}
            </p>
            <!-- 优惠码 -->
            <div class="discount-box">
              <discount-code v-if="!discount" @get-discount="getDiscount" scene='new' :product_id='id' :qty="qty"
                :amount="totalPrice" :billing_cycle_time="duration">
              </discount-code>
              <div class="discount-codeNumber" v-else>{{promo.promo_code}}
                <van-icon name="close" class="remove-discountCode" @click="canclePromo"></van-icon>
              </div>
              <event-code :eventpromotion="promo.event_promotion" :product_id='id' :qty="qty" :amount="totalPrice"
                :billing_cycle_time="duration" @change="eventChange">
              </event-code>
            </div>

          </div>
        </div>
        <van-button @click="submitOrder" :loading="submitLoading" type="primary" block
          class="btn-ok">{{lang.product_buy_now}}</van-button>
      </div>
    </div>
  </van-popup>

  <van-popup v-model:show="showConfigPick" closeable style="width: 90%;">
    <div class="common-pop-box">
      <div class="common-pop-title">{{lang.model_config}}</div>
      <div class="common-pop-body">
        <div class="cloud-box" v-if="calcModel.length > 0">
          <div class="cloud-item" :class="{active:params.model_config_id === item.id }"
            v-for="(item,index) in calcModel" :key="index" @click="cheoseConfig(item)">
            <div class="info">
              <div class="check-item"><span class="name">{{lang.mf_model}}：</span> <span class="text"> {{item.name}}
                </span> </div>
              <div class="check-item"><span class="name">{{lang.mf_cpu}}：</span> <span class="text"> {{item.cpu}}
                </span> </div>
              <div class="check-item"><span class="name">{{lang.mf_cpu_param}}：</span> <span class="text">
                  {{item.cpu_param}}</span> </div>
              <div class="check-item"><span class="name">{{lang.cloud_memery}}：</span> <span class="text">
                  {{item.memory}} </span> </div>
              <div class="check-item"><span class="name">{{lang.mf_disk}}：</span> <span class="text"> {{item.disk}}
                </span> </div>
              <div class="check-item"><span class="name">{{lang.mf_gpu}}：</span> <span class="text">
                  {{item.gpu || '--'}}
                </span> </div>

            </div>
          </div>
        </div>
        <div class="empty" v-else>
          {{lang.mf_tip9}}
        </div>
      </div>
      <div class="common-pop-fotter">
        <van-button class="can-btn" block @click="showConfigPick = false">{{lang.common_cloud_btn29}}</van-button>
        <van-button class="sub-btn" block type="primary" @click="showConfigPick = false">{{
          lang.ticket_btn6}}</van-button>
      </div>
    </div>

  </van-popup>



  <van-popup v-model:show="showLinePick" position="bottom" teleport="body">
    <van-picker option-height=".96rem" visible-option-num="8" :columns="calcLineList"
      :columns-field-names="{ text: 'name', value: 'name' }" ref="lineTypeRef">
      <template #toolbar>
        <div class="tool-bar">
          <img class="cancel-btn" @click="showLinePick = false"
            src="/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cancel.svg" alt="">
          <span class="tool-title">{{lang.mf_line}}</span>
          <span class="tool-confirm" @click="handelLineSelect">{{lang.template_text135}}</span>
        </div>
      </template>
    </van-picker>
  </van-popup>

  <van-popup v-model:show="showLoginPage" position="right" :style="{ width: '100%', height: '100%' }">
    <div class="disk-pop">
      <div class="disk-top">
        <div class="left-icon" @click="showLoginPage = false">
          <van-icon name="arrow-left"></van-icon>
        </div>
        <div class="config-title">{{lang.login_way}}</div>
        <div></div>
      </div>
      <div class="login-main">
        <van-select :columns="passColumns" :value="login_way" :columns-names=" { text: 'value', value: 'value' }"
          right-icon="arrow" :label="lang.login_way" cur-class="form-select select-field show-field mar-b-30"
          @change="changeLogin">
          <template #option="option">
            <img :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cloudDetail/ssh.svg`" alt=""
              class="image-icon" v-if="option.value === lang.security_tab1">
            <img :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cloudDetail/password.svg`"
              alt="" class="image-icon" v-if="option.value === lang.set_pas">
            <img :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cloudDetail/auto.svg`" alt=""
              class="image-icon" v-if="option.value === lang.auto_create">
            {{option.value}}
          </template>
          <template #input>
            <img :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cloudDetail/ssh.svg`" alt=""
              class="image-icon" v-if="login_way === lang.security_tab1">
            <img :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cloudDetail/password.svg`"
              alt="" class="image-icon" v-if="login_way === lang.set_pas">
            <img :src="`/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cloudDetail/auto.svg`" alt=""
              class="image-icon" v-if="login_way === lang.auto_create">
            {{login_way}}
          </template>
        </van-select>
        <p class="s-tip p-30" v-if="login_way === lang.auto_create">{{lang.mf_tip5}}</p>
        <div class="login-box" v-else>
          <van-field v-model="root_name" readonly :label="lang.login_name" input-align="right"></van-field>
          <!-- ssh -->
          <template v-if="login_way === lang.security_tab1">
            <van-select @change="chooseSshKey" :columns="sshList" :value="sshKeyText"
              :columns-names=" { text: 'name', value: 'id' }" right-icon="arrow" :label="lang.ssh_key"
              :placeholder="`${lang.placeholder_pre2}${lang.ssh_key}`"
              cur-class="form-select select-field show-field mar-b-30">
            </van-select>
            <p class="s-tip p-30 jump-box" v-if="login_way === lang.security_tab1">{{lang.mf_tip17}}&nbsp;&nbsp;
              <a href="security.htm?active=1" target="_blank" class="add-ssh">
                {{lang.mf_tip18}}
                <img src="/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/img/cloudDetail/jump.svg" alt=""
                  class="icon">
              </a>
            </p>
          </template>
          <!-- 密码 -->
          <template v-if="login_way === lang.set_pas">
            <van-field v-model="params.password" :label="lang.login_password" type="password" input-align="right"
              show-password @input="changeInput"
              :placeholder="`${lang.placeholder_pre1}${lang.login_password}`"></van-field>
            <van-field v-model="params.re_password" :label="lang.sure_password" type="password" input-align="right"
              show-password :placeholder="`${lang.placeholder_pre1}${lang.sure_password}`">
            </van-field>
            <div class="test-password">
              <div class="t-item">
                {{lang.mf_val1}}
              </div>
              <div class="t-item">
                {{lang.mf_val2}}
              </div>
              <div class="t-item">
                {{lang.mf_val3}}
              </div>
              <div class="t-item">
                {{lang.mf_val4}}
              </div>
            </div>
          </template>
        </div>
      </div>
    </div>
  </van-popup>
</div>
<!-- =======页面引入js和相关组件位置======= -->
<script src="/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/api/mf_dcim.js"></script>
<script src="/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/lang/index.js"></script>
<script src="/plugins/reserver/mf_dcim/template/clientarea/mobile/overseas/js/dcim_goods.js"></script>